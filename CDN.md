# CDN

## 什么是CDN?

CDN是构建在网络之上的内容分发网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，降低网络拥塞，
提高用户访问响应速度和命中率。CDN的关键技术主要有内容存储和分发技术(智能路由)。

CDN的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。CDN客户不需要改动原来的网站结构，只需要改动少量的DNS配置，就可以加快网络的响应速度。

## CDN的实现原理以及和传统网络结构实现原理

### 传统网络结构

用户在自己的浏览器中输入要访问的网站的域名  --> 查看缓存(本地DNS缓存)，没有 --> 本地DNS将请求发到网站授权的DNS服务器 --> 授权DNS将服务器的IP地址作为解析结果送给本地DNS --> 本地DNS将解析结果返还给用户，同时将该解析结果保存在自己的缓存中，直到相应的TTL（生存周期）过期，才再向网站的授权DNS请求解析 --> 用户在得到IP地址后，向该地址所指向的网站的服务器进行访问

### CDN

和传统的区别:在客户端和服务器之间设置了cookie

用户向浏览器提供要访问网站的域名 --> 域名解析的请求被发往网站的DNS域名解析服务器 -->  由于网站的DNS域名解析服务器对此域名的解析设置了CNAME，请求被指向CDN网络中的智能DNS负载均衡系统 --> 智能DNS负载均衡系统对域名进行智能解析，将响应速度最快的节点IP返回给用户 --> 浏览器在得到速度最快节点的IP地址以后，向CDN节点发出访问请求 --> 由于是第一次访问，CDN节点将回到源站取用户请求的数据并发给用户 --> 当有其他用户再次访问同样内容时，CDN将直接将数据返回给客户，完成请求/服务过程。 

#### CNAME

可以用于当您拥有多个域名需要指向同一服务器IP，此时您就可以将一个域名做A记录(主机名（或域名）对应的IP地址记录)指向服务器IP，然后将其他的域名做别名(即CNAME)到A记录的域名上；那么当您的服务器IP地址变更时，您就可以不必对一个一个域名做更改指向了，只需要更改A记录的那个域名到服务器新IP上，其他做别名（即CNAME）的那些域名的指向将自动更改到新的IP地址上（以上操作均需要在DNS处执行）。
